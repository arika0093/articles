---
title: "ã€C#ã€‘åŒã˜5è¡Œã®ã‚³ãƒ¼ãƒ‰ãŒå…¨ãé•ã£ã¦è¦‹ãˆã‚‹12ã®ç¬é–“ã€ã«å¯¾ã™ã‚‹C#ã§ã®å›ç­”"
emoji: "ğŸš¢"
type: "tech"
topics: ["dotnet"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯[ãƒ–ãƒ­ã‚°](https://eclairs.cc/posts/2025/20250823/csharp-learn-answer)ã§ã‚‚å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚
:::


ã“ã‚“ãªè¨˜äº‹ãŒTwitterã«æµã‚Œã¦ãã¾ã—ãŸã€‚ 
https://zenn.dev/coconala/articles/reasons-for-continuing-to-learn

C#ã§åŒã˜ã‚ˆã†ãªã“ã¨ã‚’ã‚„ã£ã¦ã¿ã¾ã™ã€‚
å…ƒè¨˜äº‹ã¯ãŠãã‚‰ããƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æƒ³å®šãªã®ã§ã€ã“ã¡ã‚‰ã‚‚ä¼¼ãŸã‚ˆã†ãªç’°å¢ƒã‚’æƒ³å®šã—ã¦ã„ãã¾ã™ã€‚

:::message

C#ã ã¨å…ƒã‚³ãƒ¼ãƒ‰ã‚’ã»ã¼å¤‰ãˆãšã«è§£æ±ºã§ãã¡ã‚ƒã†ã‚ˆï¼ã¨ã„ã†ã®ãŒè¨€ã„ãŸã„ã ã‘ã®è¨˜äº‹ã§ã™ã€‚

:::

## å…ƒã®ã‚³ãƒ¼ãƒ‰

javascriptã§æ›¸ã‹ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒå…ƒã«ãªã£ã¦ã„ã¾ã™ã€‚

```js
async function getUserName(userId) {
  const response = await fetch(`https://api.example.com/users/${userId}`);
  const user = await response.json();
  return user.name;
}
```

ã¾ãšã¯ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’C#ã§æ›¸ã„ã¦ã¿ã¾ã™ã€‚ã“ã‚“ãªæ„Ÿã˜ã§ã—ã‚‡ã†ã‹ã€‚
5è¡Œã‹ã‚‰11è¡Œã«ãªã‚Šã¾ã—ãŸãŒã€ã¾ã‚è¨±å®¹ç¯„å›²ã§ã—ã‚‡ã†ã€‚

```cs
public class GetUserNameService(IHttpClientFactory httpClientFactory)
{
    public async Task<string> GetUserNameAsync(string userId)
    {
        var httpClient = httpClientFactory.CreateClient();
        var response = await httpClient.GetAsync($"https://api.example.com/users/{userId}");
        var userJson = await response.Content.ReadAsStringAsync();
        var user = JsonSerializer.Deserialize<User>(userJson);
        return user.Name;
    }
}
```

## æœ€çµ‚å½¢ã®ã‚³ãƒ¼ãƒ‰
C#ã§å…ƒè¨˜äº‹ã®é …ç›®ã‚’ã™ã¹ã¦è€ƒæ…®ã—ãŸå ´åˆã€ã‚³ãƒ¼ãƒ‰ã¯ã©ã†ãªã‚‹ã‹ï¼Ÿã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚
APIã®ä»•æ§˜ã¯ãã®ã¾ã¾ã¨ä»®å®šã—ã¤ã¤[^1]ã€æ¥µåŠ›å…ƒè¨˜äº‹ã«å¯„ã›ã¦ã„ãï¼ˆä¸å¿…è¦ãªã®ã¯é™¤ãï¼‰ã¨â€¦â€¦

[^1]: ãã“ã¾ã§è©±ã™ã¨ã‚­ãƒªãŒãªã„ã‹ã‚‰ã§ã™ã€‚ãã‚‚ãã‚‚C#ã®å ´åˆã€APIå©ãã‚ˆã‚Šã‚‚MagicOnionã¨ã‹BlazorServerã¨ã‹ã§ç›´æ¥é€šä¿¡ã—ãŸã»ã†ãŒæ¥½ãªæ°—ãŒã—ã¦ã„ã‚‹

```cs diff
public class GetUserNameService(IHttpClientFactory httpClientFactory)
{
-   public async Task<string> GetUserNameAsync(string userId)
+   public async Task<string> GetUserNameAsync(int userId)
    {
        var httpClient = httpClientFactory.CreateClient();
-       var response = await httpClient.GetAsync($"https://api.example.com/users/{userId}");
+       var response = await httpClient.GetAsync($"https://api/users/{userId}");
+       response.EnsureSuccessStatusCode();
        var userJson = await response.Content.ReadAsStringAsync();
        var user = JsonSerializer.Deserialize<User>(userJson);
        return user.Name;
    }
}
```

ã»ã¼å¤‰ã‚ã£ã¦ãªã„ã§ã™ã­ã€‚C#ã™ã”ã„ï¼
ã¨ã„ã†ã®ã¯èª‡å¤§åºƒå‘Šã§ã™ãŒã€å®Ÿéš›ã©ã®ã‚ˆã†ã«è§£æ±ºã—ã¦ã„ã‚‹ã‹ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
> APIã§500ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã¨ã€ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ
> ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®JSONã«å¶ç„¶"name": "Internal Server Error"ãŒå«ã¾ã‚Œã¦ã„ãŸã‚‰ï¼Ÿ

å‰è€…ã¯`response.EnsureSuccessStatusCode()`ã‚’å…¥ã‚Œã‚‹ã“ã¨ã§è§£æ±ºã€‚
ã¾ãŸã€ã„ãšã‚Œã«ã›ã‚ˆ`JsonSerializer.Deserialize`ã§`User`å‹ã«ãƒ‘ãƒ¼ã‚¹ã§ããšã«ã‚³ã‚±ã¾ã™ã€‚

> Resultå‹ï¼ˆæˆå¦ã‚’å‹ãƒ¬ãƒ™ãƒ«ã§ä¿æŒï¼‰ ã®ã‚ˆã†ãªã€ã‚¨ãƒ©ãƒ¼ã‚’æ˜ç¤ºçš„ã«æ‰±ã†æ‰‹æ³•ã®ä¾¡å€¤ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

å…ƒè¨˜äº‹ã§ã¯`Result`å‹ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¦ã„ã¾ã—ãŸãŒã€åŸºæœ¬çš„ã«ã¯ä¾‹å¤–ã§è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚
ãã‚Œã‹`string?`ã«ã—ã¦`null`ã‚’è¿”ã™ã¨ã‹ã€‚ã“ã¡ã‚‰ãªã‚‰Nullãƒã‚§ãƒƒã‚¯ã ã‘ã§ï¼ˆç°¡æ˜“çš„ãªï¼‰ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒã§ãã¾ã™ã€‚

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
> userIdã«/admin/1ãŒå…¥ã£ã¦æ¥ãŸã‚‰ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

æœ€ä½é™ã®å¯¾ç­–ã¨ã—ã¦ã€`userId`ã‚’`int`ã«ã—ã¾ã—ãŸã€‚
ã¾ã‚ã€ãã‚‚ãã‚‚ãƒ‘ã‚±ãƒƒãƒˆè§£æã‚„DevTools, dnSpyç­‰ã§æ¥ç¶šå…ˆã‚’è¦‹ã‚‰ã‚Œã‚‹ãƒ»å¤‰ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ã’ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ã¯ã‚ã‚‹ã®ã§ã€APIå´ã§ã®å¯¾ç­–ã¯å¿…é ˆã§ã™ã€‚

### èªè¨¼ãƒ»èªå¯
> èªè¨¼ï¼ˆèª°ã§ã‚ã‚‹ã‹ã®ç¢ºèªï¼‰ã‚‚èªå¯ï¼ˆä½•ãŒã§ãã‚‹ã‹ã®ç¢ºèªï¼‰ã‚‚ãªã

C#ã®è‰¯ã„ã¨ã“ã‚ã¨ã—ã¦ã€DIã§ã“ã®ã‚ãŸã‚Šã®è¨­å®šã‚’å¾Œä»˜ã§ãã¾ã™ã€‚
ãªã®ã§ã€`IHttpClientFactory`ã§æ‹¾ã£ã¦ããŸ`HttpClient`ã«ã¯ã™ã§ã«èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã€ãªã©ãŒå¯èƒ½ã§ã™ã€‚
å…ƒã®ã‚³ãƒ¼ãƒ‰ãŒæ±šã‚Œãªã„ã®ãŒãƒã‚¤ãƒ³ãƒˆã€‚

### ä¿¡é ¼æ€§
> é€šä¿¡å…ˆã®APIã‹ã‚‰å¿œç­”ãŒãªã„å ´åˆã€ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ
> ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚‚ãƒªãƒˆãƒ©ã‚¤ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚

`Microsoft.Extensions.Http.Resilience`ã®`AddStandardResilienceHandler`ã‚’ä½¿ã†ã“ã¨ã§ã€ãƒªãƒˆãƒ©ã‚¤ã‚„ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒç°¡å˜ã«è¨­å®šã§ãã¾ã™ã€‚æ¨™æº–ã§ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚[å‚è€ƒ](https://blog.neno.dev/entry/2024/08/08/171524)
* RateLimit: åŒæ™‚ã«æœ€å¤§1000
* ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: 10ç§’, ãƒˆãƒ¼ã‚¿ãƒ«30ç§’
* ãƒªãƒˆãƒ©ã‚¤: 3å›ã€é…å»¶2ç§’ã€æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
* ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼ã‚ã‚Š

ã“ã‚Œã‚‚å…ƒã‚³ãƒ¼ãƒ‰ã«æ‰‹ã‚’åŠ ãˆã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚`Program.cs`ã«æ•°è¡Œè¶³ã›ã°OKã€‚

### ä¿å®ˆæ€§
> ä¿å®ˆæ€§ã‚’å­¦ã‚“ã ã‚‰ã€ã“ã®é–¢æ•°ãŒç’°å¢ƒã‚„æš—é»™çŸ¥ã«ä¾å­˜ã—ãŸã€å¼•ãç¶™ãã®ãŒãŸã‚ã‚‰ã‚ã‚Œã‚‹ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã ã¨æ°—ã¥ãã¾ã™ã€‚
> ãã—ã¦ã€å‹å®‰å…¨æ€§ã€è¨­å®šã®å¤–éƒ¨åŒ–ãªã©ã®å¿…è¦æ€§ãŒç†è§£ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

é™çš„å‹ä»˜ã‘è¨€èªãªã®ã§ã€å‹å®‰å…¨æ€§ã¯æ‹…ä¿ã•ã‚Œã¦ã„ã¾ã™ã€‚ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼
è¨­å®šã®å¤–éƒ¨åŒ–ã®ä¾‹ã¨ã—ã¦URLã®ç›´æ›¸ããŒæŒ™ã’ã‚‰ã‚Œã¦ã„ã¾ã—ãŸãŒã€ã“ã¡ã‚‰ã‚‚`ServiceDiscovery`ã‚’ä½¿ã†ã“ã¨ã§ç°¡å˜ã«è§£æ±ºã§ãã¾ã™ã€‚
ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåã‚’`http://api`ã«ã—ã¦ãŠã„ã¦ã€`appsettings.json`ã‚„ç’°å¢ƒå¤‰æ•°ã§å®Ÿéš›ã®URLã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚
ã¾ãŸã€ãã®ä»–è¨­å®šãŒå¿…è¦ãªã‚‰`IConfiguration`ã‚’DIã§æ³¨å…¥ã™ã‚Œã°è‰¯ã„ã ã‘ã§ã™ã€‚
ã“ã¡ã‚‰ã‚‚`Program.cs`ã«æ•°è¡Œè¶³ã›ã°OKã€‚

### å¯è¦³æ¸¬æ€§
> æœ¬ç•ªç’°å¢ƒã§ã€Œå‡¦ç†ãŒé…ã„ã€ã€Œã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€ã¨å ±å‘Šã•ã‚ŒãŸã‚‰ã€ã©ã†ã‚„ã£ã¦èª¿æŸ»ã™ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ã“ã‚Œã‚‚DIã§`OpenTelemetry`ãªã©ã‚’ç™»éŒ²ã—ã¦ãŠã‘ã°ã€ã‚³ãƒ¼ãƒ‰ã«æ‰‹ã‚’åŠ ãˆãšã«æ¸ˆã¿ã¾ã™ã€‚
[Aspireã§æä¾›ã•ã‚Œã¦ã„ã‚‹Dashboard](https://learn.microsoft.com/ja-jp/dotnet/aspire/fundamentals/dashboard/overview)ã¯ã‹ãªã‚Šè¦‹ã‚„ã™ãã¦ä¾¿åˆ©ã§ã™ã€‚

## ä½•ãŒè¨€ã„ãŸã„ã‹
.NETã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒã‚ã¡ã‚ƒãã¡ã‚ƒå……å®Ÿã—ã¦ã„ã¦ã€å…ƒè¨˜äº‹ã®ã‚ˆã†ãªå•é¡Œã¯ç°¡å˜ã«è§£æ±ºã§ãã¡ã‚ƒã£ã¦ã™ã”ã„ã­ã€ã¨ã„ã†è©±ã§ã—ãŸã€‚
ãŸã è§£æ±ºã§ãã‚‹ã ã‘ã§ãªãã€ã‚³ãƒ¼ãƒ‰ã‚’ã‚ã¾ã‚Šæ±šã•ãšã«æ¸ˆã‚€ã®ã‚‚ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šä½™è¨ˆãªåˆ¤èª­ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚Šã«ãã„ã€‚
ã‚ã¨ã¯ **äº‹å‰ã«è¨­å®šã—ã¦ãŠã‘ã°** èª°ãŒæ›¸ã„ã¦ã‚‚ã¤ã¾ã¥ããƒã‚¤ãƒ³ãƒˆãŒè§£æ¶ˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã®ã‚‚ç´ æ™´ã‚‰ã—ã„ã€‚[^2]

[^2]: äº‹å‰ã«è¨­å®šã™ã‚‹ã€ã¨ã„ã†ã®ãŒé›£ã—ã„ã®ã§ã™ãŒã€‚çŸ¥ã‚‰ãªã„ã¨è¨­å®šã§ããªã„ã®ã§â€¦â€¦

ä»Šå›ä½¿ã£ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã»ã¼å…¨éƒ¨Microsoftæä¾›ã®ã‚‚ã®ãªã®ã‚‚ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚ãã†ãã†æ¶ˆãˆãªã„ã¯ãšãªã®ã§ã€é•·æœŸçš„ã«è¦‹ã¦ã‚‚å®‰å¿ƒã€‚

ã‚ã¨ã€è¨€èªä»•æ§˜ã¨ã—ã¦é™çš„å‹ãªã®ã§ã€å…ƒè¨˜äº‹ã®å•é¡Œç‚¹ã®ã„ãã¤ã‹ã¯ãã‚‚ãã‚‚ç™ºç”Ÿã—ã¾ã›ã‚“ã€‚ç´ æ™´ã‚‰ã—ã„ã€‚

## æ¬ ç‚¹
ã‚‚ã¡ã‚ã‚“æ¬ ç‚¹ã‚‚ã‚ã‚Šã¾ã™ã€‚
ä¸€ç•ªã®å•é¡Œã¯ã€Œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå…¨ç„¶ãªã„ã€ã“ã¨ã§ã™ã€‚
ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã¯ã™ã”ã„ã®ã«ã€ãã‚Œã‚’çŸ¥ã‚‹æ–¹æ³•ãŒåˆå­¦è€…ç›®ç·šã ã¨ã‚ã¾ã‚Šç„¡ã„ï¼
ã‹ãã„ã†è‡ªåˆ†ã‚‚å…¨ç„¶ã‚ã‹ã£ã¦ãªã„ã§ã™ã€‚å¤šåˆ†ã“ã®è¨˜äº‹ã¯ã©ã“ã‹ã—ã‚‰é–“é•ã£ã¦ã‚‹ã€‚


å…ƒè¨˜äº‹ãŒä¸€ç•ªè¨€ã„ãŸã„ã§ã‚ã‚ã†ãƒã‚¤ãƒ³ãƒˆã®ã€Œã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã‚‹ã€éç¨‹ãŒC#ã®å ´åˆé›£ã—ã„ï¼ã¨ã„ã†ã®ãŒç›®ä¸‹ã®æ‚©ã¿ã§ã™ã€‚

> è‡ªèº«ã®çµŒé¨“ã ã‘ã‹ã‚‰ã€ŒãŒã‚€ã—ã‚ƒã‚‰ã€ã«å­¦ã¶ã®ã§ã¯ãªãã€å…ˆäººãŸã¡ãŒç©ã¿é‡ã­ã¦ããŸçŸ¥è­˜ã¨çµŒé¨“ã‹ã‚‰å­¦ã¶ã€ã€Œå·¨äººã®è‚©ã«ç«‹ã¨ã†ã¨ã™ã‚‹å§¿å‹¢ã€ ãŒå¤§åˆ‡ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

.NETã®è«¸ã€…ã§å·¨äººã®è‚©ã«ã¯ç«‹ã¦ã¦ã„ã‚‹ã¯ãšãªã®ã§ã€ã‚ã¨ã¯è¦–ç•Œã‚’ã‚¯ãƒªã‚¢ã«ã—ãŸã„ï¼
æ—¥æœ¬èªã®C#/ASP.NETã®æƒ…å ±ãŒã‚‚ã£ã¨å¢—ãˆã‚‹ã¨è‰¯ã„ãªã‚ã¨æ€ã„ã¾ã™ã€‚

